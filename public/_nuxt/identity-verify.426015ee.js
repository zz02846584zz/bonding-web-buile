import{a as B,r as F,A as C,e as w,b,o as _,l as g,j as a,k as y,t as A,z as E,u,U as h,q as V,C as $,f as d,h as k,a2 as S,y as I,W as U,V as q,B as D,Y as z}from"./entry.880fa512.js";const R=["for","textContent"],N={key:0},j=["src"],T={key:1,class:"p-c text-xs"},H=["id","required"],L=B({__name:"Image",props:{modelValue:{type:String,default:""},label:{type:String,default:""},id:{type:String,default:""},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(i,{emit:t}){const r=F(""),l=C({lg:"text-base",md:"text-sm",sm:"text-xs",xs:"text-xs"}),v=w(()=>l.md),x=b("message"),f=async e=>{const s=new FormData;s.append("file",e);const{data:m,error:n,message:p}=await h("/comm/upload",{body:s,multipart:!0});return n?x.value=p:m},c=async e=>{const s=e.target;if(s.files&&s.files[0]){const m=await f(s.files[0]);t("update:modelValue",m);const n=new FileReader;n.onload=p=>{var o;r.value=((o=p.target)==null?void 0:o.result)||""},n.readAsDataURL(s.files[0])}};return(e,s)=>(_(),g("div",null,[a("div",{class:y(["flex items-center mb-2",u(v)])},[a("label",{for:i.id,class:y(["block font-bold tracking-wide",[{"cursor-pointer":i.id}]]),textContent:A(i.label)},null,10,R),E(e.$slots,"label",{},void 0,!0)],2),a("div",{class:y(["relative border border-gray-300 border-opacity-40 rounded dark:bg-white/[0.05] bg-gray-100",{model:!u(r)}])},[u(r).length>0?(_(),g("div",N,[a("img",{class:"preview w-full h-full",src:u(r)},null,8,j)])):(_(),g("div",T," \u9EDE\u64CA\u4E0A\u50B3\u5716\u7247 ")),a("input",{id:i.id,type:"file",accept:"image/*",class:"absolute w-full h-full cursor-pointer opacity-0 top-0 left-0",required:i.required,onChange:c},null,40,H)],2)]))}});const P=V(L,[["__scopeId","data-v-d10ebd38"]]),W={class:"flex items-center justify-between sticky"},Y={class:"flex items-center space-x-2"},G=a("h1",{class:"text-xl font-bold"}," \u8EAB\u4EFD\u9A57\u8B49 ",-1),J=a("span",{class:"lg:pr-2 duration-150 pr-1"}," \u9001\u51FA ",-1),K={class:"py-3"},O=B({__name:"identity-verify",setup(i){const t=C({idCard:"",positive:null,negative:null}),r=b("loading"),l=b("alert"),v=$(),x=async()=>{r.value=!0;const{error:c,message:e}=await h("/user/identity-verify",{body:t,multipart:!0});if(r.value=!1,c&&e)return l.value={type:"error",text:e,center:!0};const{user:s}=q();return s.updateField({identityStatus:21,idCard:t.idCard}),l.value={type:"success",text:"\u4E0A\u50B3\u6210\u529F\uFF0C\u7B49\u5F85\u7BA1\u7406\u54E1\u5BE9\u6838",center:!0,action:()=>v.push("/my/account")}},f=()=>{if(!S.test(t.idCard))return l.value={type:"error",text:"\u8EAB\u5206\u8B49\u683C\u5F0F\u932F\u8AA4",center:!0};if(!t.positive)return l.value={type:"error",text:"\u8EAB\u5206\u8B49\u6B63\u9762\u5C1A\u672A\u4E0A\u50B3",center:!0};if(!t.negative)return l.value={type:"error",text:"\u8EAB\u5206\u8B49\u80CC\u9762\u5C1A\u672A\u4E0A\u50B3",center:!0};x()};return(c,e)=>{const s=I,m=z,n=P,p=U;return _(),g("div",null,[a("div",W,[a("div",Y,[a("div",{class:"flex items-center cursor-pointer",onClick:e[0]||(e[0]=o=>c.$router.go(-1))},[d(s,{class:"i-ic-round-arrow-back-ios text-sm lg:text-base"})]),G]),a("div",{class:"group rounded-full cursor-pointer bg-green-500 text-white font-bold px-4 lg:h-9 lg:leading-9 h-7 leading-7 flex items-center lg:text-base text-sm",onClick:f},[J,d(s,{class:"i-ic-round-arrow-forward-ios"})])]),a("div",K,[d(p,{class:"max-w-[28em]",onSubmit:f},{default:k(()=>[D(A(u(t))+" ",1),d(m,{modelValue:u(t).idCard,"onUpdate:modelValue":e[1]||(e[1]=o=>u(t).idCard=o),label:"\u8EAB\u5206\u8B49\u5B57\u865F",class:"mb-5",require:!0,placeholder:"\u4F8B: A123456789"},null,8,["modelValue"]),d(n,{id:"positive",modelValue:u(t).positive,"onUpdate:modelValue":e[2]||(e[2]=o=>u(t).positive=o),label:"\u8EAB\u5206\u8B49\u6B63\u9762",class:"mb-5",require:!0},null,8,["modelValue"]),d(n,{id:"negative",modelValue:u(t).negative,"onUpdate:modelValue":e[3]||(e[3]=o=>u(t).negative=o),label:"\u8EAB\u5206\u8B49\u80CC\u9762",require:!0},null,8,["modelValue"])]),_:1})])])}}});export{O as default};
