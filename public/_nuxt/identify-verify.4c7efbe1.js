import{a as b,r as A,z as B,e as h,b as y,o as f,l as _,j as u,k as x,t as F,y as w,u as E,S as C,q as V,B as $,f as i,h as k,s as S,V as I,U,W as q}from"./entry.d9de7e46.js";import{i as D}from"./regex.b022fd56.js";const z=["for","textContent"],R={key:0},j=["src"],N={key:1,class:"p-c text-xs"},H=["id","required"],L=b({__name:"Image",props:{modelValue:{type:String,default:""},label:{type:String,default:""},id:{type:String,default:""},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:t}){const o=A(""),r=B({lg:"text-base",md:"text-sm",sm:"text-xs",xs:"text-xs"}),g=h(()=>r.md),v=y("message"),p=async e=>{const s=new FormData;s.append("file",e);const{data:c,error:l,message:m}=await C("/comm/upload",{body:s,multipart:!0});return l?v.value=m:c},d=async e=>{const s=e.target;if(s.files&&s.files[0]){const c=await p(s.files[0]);t("update:modelValue",c);const l=new FileReader;l.onload=m=>{var a;o.value=((a=m.target)==null?void 0:a.result)||""},l.readAsDataURL(s.files[0])}};return(e,s)=>(f(),_("div",null,[u("div",{class:x(["flex items-center mb-2",E(g)])},[u("label",{for:n.id,class:x(["block font-bold tracking-wide",[{"cursor-pointer":n.id}]]),textContent:F(n.label)},null,10,z),w(e.$slots,"label",{},void 0,!0)],2),u("div",{class:x(["relative border border-gray-300 border-opacity-40 rounded dark:bg-white/[0.05] bg-gray-100",{model:!o.value}])},[o.value.length>0?(f(),_("div",R,[u("img",{class:"preview w-full h-full",src:o.value},null,8,j)])):(f(),_("div",N,"\u9EDE\u64CA\u4E0A\u50B3\u5716\u7247")),u("input",{id:n.id,type:"file",accept:"image/*",class:"absolute w-full h-full cursor-pointer opacity-0 top-0 left-0",required:n.required,onChange:d},null,40,H)],2)]))}});const P=V(L,[["__scopeId","data-v-cd586c4d"]]),T={class:"flex items-center justify-between sticky"},W={class:"flex items-center space-x-2"},G=u("h1",{class:"text-xl font-bold"}," \u8EAB\u4EFD\u9A57\u8B49 ",-1),J=u("span",{class:"pr-2 duration-150"}," \u9001\u51FA ",-1),K={class:"py-3"},Q=b({__name:"identify-verify",setup(n){const t=B({idCard:"",positive:"",negative:""}),o=y("loading"),r=y("alert"),g=$(),v=async()=>{o.value=!0;const{error:d,message:e}=await C("/user/identify-verify",{body:t,multipart:!0});if(o.value=!1,d&&e)return r.value={type:"error",text:e,center:!0};const{user:s}=U();return s.updateField({identifyVerify:"pending",idCard:t.idCard}),r.value={type:"success",text:"\u4E0A\u50B3\u6210\u529F\uFF0C\u7B49\u5F85\u7BA1\u7406\u54E1\u5BE9\u6838",center:!0,action:()=>g.push("/my/account")}},p=()=>{if(!D.test(t.idCard))return r.value={type:"error",text:"\u8EAB\u5206\u8B49\u683C\u5F0F\u932F\u8AA4",center:!0};if(!t.positive.length)return r.value={type:"error",text:"\u8EAB\u5206\u8B49\u6B63\u9762\u5C1A\u672A\u4E0A\u50B3",center:!0};if(!t.negative.length)return r.value={type:"error",text:"\u8EAB\u5206\u8B49\u80CC\u9762\u5C1A\u672A\u4E0A\u50B3",center:!0};v()};return(d,e)=>{const s=S,c=q,l=P,m=I;return f(),_("div",null,[u("div",T,[u("div",W,[u("div",{class:"flex items-center cursor-pointer",onClick:e[0]||(e[0]=a=>d.$router.go(-1))},[i(s,{class:"i-ic-round-arrow-back-ios text-sm lg:text-base"})]),G]),u("div",{class:"group rounded-full cursor-pointer bg-green-500 text-white font-bold px-4 h-9 leading-9 flex items-center",onClick:p},[J,i(s,{class:"i-ic-round-arrow-forward-ios"})])]),u("div",K,[i(m,{class:"max-w-[28em]",onSubmit:p},{default:k(()=>[i(c,{modelValue:t.idCard,"onUpdate:modelValue":e[1]||(e[1]=a=>t.idCard=a),label:"\u8EAB\u5206\u8B49\u5B57\u865F",class:"mb-5",require:!0,placeholder:"\u4F8B: A123456789"},null,8,["modelValue"]),i(l,{id:"positive",modelValue:t.positive,"onUpdate:modelValue":e[2]||(e[2]=a=>t.positive=a),label:"\u8EAB\u5206\u8B49\u6B63\u9762",class:"mb-5",require:!0},null,8,["modelValue"]),i(l,{id:"negative",modelValue:t.negative,"onUpdate:modelValue":e[3]||(e[3]=a=>t.negative=a),label:"\u8EAB\u5206\u8B49\u80CC\u9762",require:!0},null,8,["modelValue"])]),_:1})])])}}});export{Q as default};
