import{a as M,o as a,l as b,j as e,f as l,t as m,s as U,U as P,Y as W,b as H,c as C,h as L,u as r,m as $,a5 as be,v as xe,x as ge,q as ce,a8 as q,N as G,O as te,C as ye,r as F,R as we,S as T,A as ae,J as $e,K as ke,Z as Ce,P as Q,w as le,e as Le,Q as ee,$ as Y,a0 as Z}from"./entry.f0967dd5.js";import{_ as Ae,a as Ie,b as Be,c as Se}from"./Wrapper.e7f426d6.js";import{_ as Te}from"./Header.824f4848.js";import{_ as He}from"./RowLoading.47fc8971.js";import{_ as Ne}from"./Editor.0e3e4940.js";const Ee={class:"py-2 text-xs md:text-sm font-bold text-gray-600 dark:text-gray-400"},je={class:"space-y-2 lg:space-y-0 lg:flex lg:flex-wrap lg:space-x-4"},Fe={class:"flex items-center space-x-2"},Me={class:"flex items-center space-x-2"},Ue=M({__name:"Meta",props:{author:{type:Object,default:()=>{}},publishTime:{type:String,default:""}},setup(s){const o=s;return(i,f)=>{var p,n;const c=U;return a(),b("div",Ee,[e("div",je,[e("div",Fe,[l(c,{class:"i-carbon-user-avatar"}),e("span",null,m(((p=o.author)==null?void 0:p.firstName)+((n=o.author)==null?void 0:n.lastName)),1)]),e("div",Me,[l(c,{class:"i-carbon-time"}),e("span",null,m(o.publishTime),1)])])])}}}),Ve=s=>(xe("data-v-0b1d899a"),s=s(),ge(),s),Oe=["innerHTML"],De={key:0,class:"group read-more relative pt-20 pb-4 -mt-20 -mx-8"},ze=Ve(()=>e("span",{class:"mr-2"},"\u767B\u5165\u5F8C\u95B1\u8B80\u5B8C\u6574\u6587\u7AE0",-1)),Re=M({__name:"Single",props:{content:{type:String,default:""}},setup(s){const o=s,{user:i}=P(),{isLogin:f}=W(i),c=H("showAuth");return(p,n)=>{const u=U,t=be;return a(),C(t,null,{default:L(()=>[e("div",{class:"article-content",innerHTML:o.content},null,8,Oe),r(f)?$("",!0):(a(),b("div",De,[e("div",{class:"flex items-center justify-center opacity-50 group-hover:opacity-80 duration-150 cursor-pointer text-sm",onClick:n[0]||(n[0]=g=>c.value=!0)},[ze,l(u,{class:"i-ant-design-login-outlined"})])]))]),_:1})}}});const Pe=ce(Re,[["__scopeId","data-v-0b1d899a"]]),We={};function qe(s,o){return"video"}const Je=ce(We,[["render",qe]]),Ke={class:"flex flex-wrap"},Qe={class:"flex flex-wrap items-center w-full pb-4 border-gray-900/10 dark:border-gray-50/[0.2] lg:w-auto lg:pb-0 lg:pr-16 lg:mr-16 lg:border-b-0 lg:border-r-1"},Ye=e("div",{class:"mr-6 overflow-hidden rounded-full shadow-sm shadow w-16 h-16 shadow-blue-200"},[e("img",{src:q,class:"object-cover w-full h-full"})],-1),Ze={class:"font-bold"},Ge={class:"pb-1 text-lg"},Xe=e("p",{class:"text-sm tracking-widest dark:text-gray-400"}," \u5C08\u6B04\u7DE8\u8F2F ",-1),et=["innerHTML"],tt=M({__name:"Author",props:{author:{type:Object,default:()=>{}}},setup(s){const o=s;return(i,f)=>{var c,p,n;return a(),b("div",Ke,[e("div",Qe,[Ye,e("div",Ze,[e("p",Ge,m(((c=o.author)==null?void 0:c.firstName)+((p=o.author)==null?void 0:p.lastName)),1),Xe])]),e("div",{class:"flex-1 py-3 space-y-3 text-sm text-gray-800 lg:pr-4 dark:text-gray-300",innerHTML:((n=o.author)==null?void 0:n.intro)||"\u5C1A\u672A\u8F38\u5165\u81EA\u6211\u4ECB\u7D39"},null,8,et)])}}}),st={class:"block"},ot={class:"flex flex-wrap w-full"},nt={class:"relative w-20 h-20 mr-4"},at=["src"],lt={class:"flex flex-col content-between flex-1"},ct={class:"text-base font-bold ellipsis"},it={class:"flex flex-wrap justify-between w-full pt-1 pb-2 mt-auto text-xs text-gray-600 dark:text-gray-400"},rt={class:"flex w-full mb-1 space-x-4 text-gray-700 dark:text-gray-300",itemprop:"author"},ut={class:"flex"},dt={class:"tracking-wider",itemprop:"create-date"},mt={class:"flex"},_t={class:"flex items-center mr-3 space-x-2"},pt={class:"flex items-center mr-3 space-x-2"},ft={__name:"Column",props:{list:{type:Array,default:()=>[]},infinite:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},setup(s){return(o,i)=>{const f=U,c=ye,p=He;return a(),b("div",st,[(a(!0),b(G,null,te(s.list,n=>(a(),C(c,{key:n.id,to:`/news/article/${n.slug}`,class:"flex pb-3 mb-3 border-gray-200 dark:border-gray-700 border-b-1 last-border-b-0 last-mb-0 last-pb-0"},{default:L(()=>{var u,t;return[e("div",ot,[e("div",nt,[e("img",{src:n.thumbnail,class:"absolute object-cover w-full h-full"},null,8,at)]),e("div",lt,[e("h3",ct,m(n.title),1),e("div",it,[e("div",rt,[e("p",null,m(n.author),1),e("p",null,m(n.categories),1)]),e("div",ut,[e("span",dt,m((t=(u=n.publishTime)==null?void 0:u.split(" "))==null?void 0:t.shift()),1)]),e("div",mt,[e("div",_t,[l(f,{class:"i-ic-baseline-thumb-up text-green-400"}),e("span",null,m(n.likes),1)]),e("div",pt,[l(f,{class:"i-ion-eye-sharp text-green-400"}),e("span",null,m(n.views),1)])])])])])]}),_:2},1032,["to"]))),128)),s.infinite&&s.loading?(a(),C(p,{key:0,class:"mt-2"})):$("",!0)])}}},ht={class:"pb-5"},vt={key:0},bt={class:"flex"},xt={class:"mr-4"},gt=e("div",{class:"rounded-full overflow-hidden w-12 h-12"},[e("img",{src:q,class:"object-cover w-full h-full"})],-1),yt={class:"text-center text-xs mt-2"},wt={class:"flex-1"},$t={key:1},kt=we('<div class="mr-4"><div class="rounded-full overflow-hidden w-12 h-12"><img src="'+q+'" class="object-cover w-full h-full"></div></div><div class="flex-1"><div class="w-full h-14 rounded py-2 px-4 text-sm mb-4 cursor-pointer bg-transparent dark:focus:bg-gray-300/[0.1] duration-200 border border-gray-300 dark:border-gray-300/[0.2]"><span class="opacity-70"> \u8ACB\u5148\u767B\u5165\u6703\u54E1...</span></div><div class="text-sm cursor-pointer inline-block text-center bg-green-500 px-3 rounded h-8 leading-8 text-white"> \u767B\u5165 </div></div>',2),Ct=[kt],ie=M({__name:"Form",emits:["submit"],setup(s,{emit:o}){const{user:i}=P(),{isLogin:f,info:c}=W(i),p=H("showAuth"),n=F(""),u=()=>{o("submit",n.value),n.value=""};return(t,g)=>{var I,N;const A=Ne;return a(),b("div",ht,[r(f)?(a(),b("div",vt,[e("div",bt,[e("div",xt,[gt,e("div",yt,m(((I=r(c))==null?void 0:I.firstName)+((N=r(c))==null?void 0:N.lastName)),1)]),e("div",wt,[l(A,{modelValue:n.value,"onUpdate:modelValue":g[0]||(g[0]=x=>n.value=x),placeholder:"\u767C\u8868\u7559\u8A00...",class:"mb-3"},null,8,["modelValue"]),e("div",{class:"cursor-pointer inline-block text-sm text-center bg-green-400 dark:bg-green-400 w-fit px-3 rounded h-8 leading-8 text-white",onClick:u}," \u9001\u51FA ")])])])):$("",!0),r(f)?$("",!0):(a(),b("div",$t,[e("div",{class:"flex",onClick:g[1]||(g[1]=x=>p.value=!0)},Ct)]))])}}}),Lt={class:"flex py-3 mb-1 border-b last:border-b-0 last:pb-0 last:mb-0 last-border-0 border-gray-200 dark:border-gray-700"},At=e("div",{class:"rounded-full mr-4 overflow-hidden w-10 h-10"},[e("img",{src:q,class:"object-cover w-full h-full"})],-1),It={class:"flex-1"},Bt={class:"text-sm"},St={class:"text-xs opacity-80 pb-2"},Tt=["innerHTML"],Ht={class:"flex items-center space-x-4"},Nt={class:"min-w-3 text-left"},Et=M({__name:"Child",props:["comment","articleId"],setup(s){const o=s,i=H("message"),f=H("auth"),{user:c}=P(),{isLogin:p}=W(c),n=async u=>{if(!p.value)return f.value=!0;const{data:t,error:g,message:A}=await T("/comment/like",{body:{commentId:u.id,articleId:o.articleId}});if(g)return i.value=A;u.isLike=t,u.likes=+u.likes+(t?1:-1)};return(u,t)=>{const g=U;return a(),b("div",Lt,[At,e("div",It,[e("p",Bt,m(s.comment.author),1),e("p",St,m(s.comment.createTime),1),e("div",{class:"pb-2",innerHTML:s.comment.content},null,8,Tt),e("div",Ht,[e("div",{class:"cursor-pointer flex items-center space-x-1",onClick:t[0]||(t[0]=A=>n(s.comment))},[s.comment.isLike?$("",!0):(a(),C(g,{key:0,class:"i-ic-outline-thumb-up w-4"})),s.comment.isLike?(a(),C(g,{key:1,class:"text-blue-600 w-4 i-ic-round-thumb-up"})):$("",!0),e("span",Nt,m(s.comment.likes),1)])])])])}}}),jt={class:"py-3 mb-1 border-b border-gray-200 dark:border-gray-700 last:border-b-0 last:pb-0 last:mb-0"},Ft={class:"flex w-full"},Mt=e("div",{class:"rounded-full mr-4 overflow-hidden w-12 h-12"},[e("img",{src:q,class:"object-cover w-full h-full"})],-1),Ut={class:"flex-1"},Vt={class:"text-sm"},Ot={class:"text-xs opacity-80 pb-2"},Dt=["innerHTML"],zt={class:"flex items-center space-x-4"},Rt={class:"min-w-3 text-left ml-1"},Pt={class:"w-fit text-sm cursor-pointer pt-4 pb-2 text-gary-800 dark:text-gray-200"},Wt={key:0,class:"w-full"},qt={class:"py-3 mb-1 border-b last:border-b-0 last-border-0 border-gray-200 dark:border-gray-700"},Jt=M({__name:"Item",props:{comment:{type:Object,default:()=>{}},articleId:{type:Number,default:null}},emits:["like"],setup(s){const o=s,i=F([]),f=F({}),c=F(!1),p=async x=>{c.value=!0;const{data:d}=await T("/comment/page",{body:{parentId:x}});(d==null?void 0:d.list.length)&&!i.value.length&&(i.value.push(...d.list),f.value=d.pagination),console.log(i.value)},n=H("message"),u=H("showAuth"),{user:t}=P(),{isLogin:g}=W(t),A=async x=>{if(!g.value)return u.value=!0;const{data:d,error:v,message:E}=await T("/comment/like",{body:{commentId:x.id,articleId:o.articleId}});if(v)return n.value=E;x.isLike=d,x.likes=+x.likes+(d?1:-1)},I=async x=>{const{error:d,message:v,data:E}=await T("/comment/create",{body:{content:x,articleId:o.articleId,parentId:o.comment.id}});if(d)return n.value=v;i.value.unshift(E)},N=x=>{I(x)};return(x,d)=>{const v=U,E=Et,V=ie;return a(),b("div",jt,[e("div",Ft,[Mt,e("div",Ut,[e("p",Vt,m(s.comment.author),1),e("p",Ot,m(s.comment.createTime),1),e("div",{class:"pb-2",innerHTML:s.comment.content},null,8,Dt),e("div",zt,[e("div",{class:"cursor-pointer flex items-center",onClick:d[0]||(d[0]=B=>A(s.comment))},[s.comment.isLike?$("",!0):(a(),C(v,{key:0,class:"i-ic-outline-thumb-up w-4"})),s.comment.isLike?(a(),C(v,{key:1,class:"text-blue-600 w-4 i-ic-baseline-thumb-up"})):$("",!0),e("span",Rt,m(s.comment.likes),1)]),e("div",{class:"flex items-center space-x-1 cursor-pointer",onClick:d[1]||(d[1]=B=>c.value=!c.value)},[l(v,{class:"i-uil-comment-alt-dots w-4"}),e("span",null,m(s.comment.comments),1)])]),s.comment.hasChild?(a(),b(G,{key:0},[e("div",Pt,[c.value?$("",!0):(a(),b("div",{key:0,class:"flex items-center text-sm space-x-2",onClick:d[2]||(d[2]=B=>p(s.comment.id))},[l(v,{class:"i-ion-md-arrow-dropdown w-4 mr-1 flex items-center"}),ae(" \u5C55\u958B ")])),c.value?(a(),b("div",{key:1,class:"flex items-center space-x-2",onClick:d[3]||(d[3]=B=>c.value=!1)},[l(v,{class:"i-ion-md-arrow-dropup w-4 mr-1 flex items-center"}),ae(" \u6536\u8D77 ")])):$("",!0)]),c.value?(a(),b("div",Wt,[e("div",qt,[(a(!0),b(G,null,te(i.value,B=>(a(),C(E,{key:B.id,comment:B,"article-id":s.articleId},null,8,["comment","article-id"]))),128))])])):$("",!0)],64)):$("",!0),c.value?(a(),C(V,{key:1,class:"pt-4 -ml-8 md:ml-0",onSubmit:N})):$("",!0)])])])}}}),Kt={class:"comment-container"},Qt={__name:"Comment",props:{commentList:{type:Array,default:()=>[]},articleId:{type:Number,default:null}},emits:["submit"],setup(s,{emit:o}){const i=f=>{o("submit",f)};return(f,c)=>{const p=ie,n=Jt;return a(),b("div",Kt,[l(p,{onSubmit:i}),(a(!0),b(G,null,te(s.commentList,(u,t)=>(a(),C(n,{key:t,"article-id":s.articleId,comment:u,onSubmit:i},null,8,["article-id","comment"]))),128))])}}};function Yt(){const s=F(0),o=()=>s.value=document.documentElement.scrollTop;return $e(()=>{window.addEventListener("scroll",o)}),ke(()=>{window.removeEventListener("scroll",o)}),{offset:s}}const Zt={class:"fb space-x-4 text-gray-500 dark:text-gray-400 lg:space-x-4"},Gt={class:"ml-auto fic space-x-2 md:space-x-5"},Xt={class:"ml-1"},es={class:"ml-1"},ts={class:"fic space-x-1"},ss={class:"mb-1 md:mb-3 text-lg md:text-2xl font-bold"},os={class:"pb-6"},ns={class:"px-4 lg:px-8 pt-3 pb-6 -mx-4 lg:-mx-8 border-t-1 border-b-1 border-gray-900/10 dark:border-gray-50/[0.2]"},as={class:"px-4 lg:px-8 pt-3 pb-6 -mx-4 lg:-mx-8 border-gray-900/10 dark:border-gray-50/[0.2]"},ds=M({__name:"[articleSlug]",async setup(s){var se;let o,i;const{user:f}=P(),{isLogin:c,token:p}=W(f),n=Ce(),{articleSlug:u}=n.params,{data:t,refresh:g}=([o,i]=Q(()=>ee(`article-info-${u}`,"/news/article",{body:{slug:u}})),o=await o,i(),o);le(p,async()=>{await g()}),((se=t.value)==null?void 0:se.isPreview)&&p&&([o,i]=Q(()=>g()),await o,i());const{data:A}=([o,i]=Q(()=>{var _;return ee(`article-more-${u}`,"/news/list",{body:{articleId:(_=t.value)==null?void 0:_.id}})}),o=await o,i(),o),I=H("message"),N=H("showAuth"),x=async()=>{if(c.value){const{data:{status:_=!1},error:k,message:h}=await T("/news/like",{body:{id:t.value.id}});if(k)return I.value=h.value;t.value.isLike=_,t.value.likes=+t.value.likes+(_?1:-1)}else N.value=!0},d=async()=>{if(c.value){const{data:{status:_=!1},error:k,message:h}=await T("/news/collection",{body:{id:t.value.id}});if(k.value)return I.value=h.value;t.value.isCollection=_,t.value.collections=+t.value.collections+(_?1:-1)}else N.value=!0},{data:v}=([o,i]=Q(()=>{var _;return ee(`article-comment-${u}`,"/comment/page",{body:{articleId:(_=t.value)==null?void 0:_.id,page:1,size:12}})}),o=await o,i(),o),E=async _=>{var j;const{error:k,message:h,data:y}=await T("/comment/create",{body:{content:_,articleId:(j=t.value)==null?void 0:j.id}});if(k)return I.value=h;v.value.list.unshift(y)},V=F(null),B=Le(()=>{var y;const{page:_=1,size:k=1,total:h=1}=(y=v.value)==null?void 0:y.pagination;return _*k>=h}),X=F(!1),re=async()=>{var h,y;if(B.value||!v.value.length)return;const _=((h=v.value)==null?void 0:h.pagination.page)+1;X.value=!0;const{data:k}=await T("/comment/page",{body:{articleId:(y=t.value)==null?void 0:y.id,page:_}});X.value=!1,v.value.list.push(...k.list),v.value.pagination=k.pagination},{offset:ue}=Yt();return le(ue,_=>{var j,J;if(X.value)return;const k=window.innerHeight,h=((j=V.value)==null?void 0:j.offsetTop)||0,y=((J=V.value)==null?void 0:J.offsetHeight)||0;h+y-_-k<-50&&re()}),(_,k)=>{const h=U,y=Ie,j=Te,J=Ue,de=Pe,me=Je,K=Be,_e=tt,pe=ft,fe=Qt,he=Se,ve=Ae;return a(),C(ve,null,{default:L(()=>[l(j,{class:"sticky z-10 bg-white border-b border-gray-900/10 top-12 dark:bg-gray-900 dark:border-gray-700"},{default:L(()=>{var w;return[l(y,{title:(w=r(t))==null?void 0:w.title,size:"sm",color:"gray-500","dark-color":"gray-400",previous:!0,class:"capitalize"},{default:L(()=>{var S,O,D,z,R,oe,ne;return[e("div",Zt,[e("div",Gt,[e("div",{class:"cursor-pointer fic",onClick:d},[Y(l(h,{class:"i-ion-heart-outline w-6 lt-md:text-sm"},null,512),[[Z,!((S=r(t))!=null&&S.isCollection)]]),Y(l(h,{class:"i-ion-heart-sharp text-red-600 w-6 lt-md:text-sm"},null,512),[[Z,(O=r(t))==null?void 0:O.isCollection]]),e("span",Xt,m(+((D=r(t))==null?void 0:D.collections)),1)]),e("div",{class:"cursor-pointer fic",onClick:x},[Y(l(h,{class:"i-ic-outline-thumb-up w-6 lt-md:text-sm"},null,512),[[Z,!((z=r(t))!=null&&z.isLike)]]),Y(l(h,{class:"i-ic-baseline-thumb-up w-6 text-blue-600 lt-md:text-sm"},null,512),[[Z,(R=r(t))==null?void 0:R.isLike]]),e("span",es,m(+((oe=r(t))==null?void 0:oe.likes)),1)]),e("div",ts,[l(h,{class:"i-ion-eye-sharp w-6 lt-md:text-sm"}),e("span",null,m(+((ne=r(t))==null?void 0:ne.views)),1)])])])]}),_:1},8,["title"])]}),_:1}),l(he,null,{default:L(()=>[l(K,null,{default:L(()=>{var w,S,O,D,z,R;return[e("h1",ss,m((w=r(t))==null?void 0:w.title),1),l(J,{author:(S=r(t))==null?void 0:S.author,"publish-time":(O=r(t))==null?void 0:O.publishTime,class:"mb-3 md:mb-5"},null,8,["author","publish-time"]),e("div",os,[((D=r(t))==null?void 0:D.type)==="normal"?(a(),C(de,{key:0,content:r(t).content||"\u7121\u5167\u5BB9"},null,8,["content"])):((z=r(t))==null?void 0:z.type)==="video"?(a(),C(me,{key:1,content:(R=r(t))==null?void 0:R.content},null,8,["content"])):$("",!0)])]}),_:1}),l(K,null,{default:L(()=>{var w;return[e("div",ns,[l(y,{class:"mb-2",title:"\u64B0\u5BEB\u4EBA"}),l(_e,{author:(w=r(t))==null?void 0:w.author},null,8,["author"])])]}),_:1}),l(K,null,{default:L(()=>{var w;return[e("div",as,[l(y,{title:"\u76F8\u95DC\u6587\u7AE0",class:"pb-5 mb-2"}),l(pe,{tag:"h3",list:(w=r(A))!=null?w:[]},null,8,["list"])])]}),_:1}),e("div",{ref_key:"comment",ref:V},[l(K,null,{default:L(()=>{var w,S;return[l(y,{title:"\u7559\u8A00\u5340",class:"pb-5 mb-2"}),l(fe,{"comment-list":(S=(w=r(v))==null?void 0:w.list)!=null?S:[],"article-id":r(t).id,onSubmit:E},null,8,["comment-list","article-id"])]}),_:1})],512)]),_:1})]),_:1})}}});export{ds as default};
