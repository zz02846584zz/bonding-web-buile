import{a as B,r as h,z as A,e as F,b as y,o as p,l as f,j as s,k as x,t as E,y as w,u as _,W as C,q as V,B as $,f as d,h as k,X as S,Y as q,Z as I}from"./entry.d135e3cc.js";import{F as D,M as U}from"./arrow-right-thin.aabd729f.js";import{i as R}from"./regex.2eecabee.js";const z=["for","textContent"],j={key:0},L=["src"],M={key:1,class:"p-c text-xs"},N=["id","required"],T=B({__name:"Image",props:{modelValue:{type:String,default:""},label:{type:String,default:""},id:{type:String,default:""},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(o,{emit:t}){const r=h(""),l=A({lg:"text-base",md:"text-sm",sm:"text-xs",xs:"text-xs"}),g=F(()=>l.md),m=y("message"),v=async e=>{const u=new FormData;u.append("file",e);const{data:n,error:i,message:a}=await C("/comm/upload",{body:u,multipart:!0});return i?m.value=a:n},c=async e=>{const u=e.target;if(u.files&&u.files[0]){const n=await v(u.files[0]);t("update:modelValue",n);const i=new FileReader;i.onload=a=>{var b;r.value=((b=a.target)==null?void 0:b.result)||""},i.readAsDataURL(u.files[0])}};return(e,u)=>(p(),f("div",null,[s("div",{class:x(["flex items-center mb-2",_(g)])},[s("label",{for:o.id,class:x(["block font-bold tracking-wide",[{"cursor-pointer":o.id}]]),textContent:E(o.label)},null,10,z),w(e.$slots,"label",{},void 0,!0)],2),s("div",{class:x(["relative border border-gray-300 border-opacity-40 rounded dark:bg-white/[0.05] bg-gray-100",{model:!r.value}])},[r.value.length>0?(p(),f("div",j,[s("img",{class:"preview w-full h-full",src:r.value},null,8,L)])):(p(),f("div",M,"\u9EDE\u64CA\u4E0A\u50B3\u5716\u7247")),s("input",{id:o.id,type:"file",accept:"image/*",class:"absolute w-full h-full cursor-pointer opacity-0 top-0 left-0",required:o.required,onChange:c},null,40,N)],2)]))}}),H=V(T,[["__scopeId","data-v-cd586c4d"]]),P={class:"flex items-center justify-between sticky"},W={class:"flex items-center space-x-2"},X=s("h1",{class:"text-xl font-bold"},"\u8EAB\u4EFD\u9A57\u8B49",-1),Y=s("span",{class:"pr-2 duration-150"}," \u9001\u51FA ",-1),Z={class:"py-3"},O=B({__name:"identify-verify",setup(o){const t=A({idCard:"",positive:"",negative:""}),r=y("loading"),l=y("alert"),g=$(),m=()=>{if(!R.test(t.idCard))return l.value={type:"error",text:"\u8EAB\u5206\u8B49\u683C\u5F0F\u932F\u8AA4",center:!0};if(!t.positive.length)return l.value={type:"error",text:"\u8EAB\u5206\u8B49\u6B63\u9762\u5C1A\u672A\u4E0A\u50B3",center:!0};if(!t.negative.length)return l.value={type:"error",text:"\u8EAB\u5206\u8B49\u80CC\u9762\u5C1A\u672A\u4E0A\u50B3",center:!0};v()},v=async()=>{r.value=!0;const{error:c,message:e}=await C("/user/identify-verify",{body:t,multipart:!0});if(r.value=!1,c&&e)return l.value={type:"error",text:e,center:!0};const{user:u}=S();return u.updateField({identifyVerify:"pending",idCard:t.idCard}),l.value={type:"success",text:"\u4E0A\u50B3\u6210\u529F\uFF0C\u7B49\u5F85\u7BA1\u7406\u54E1\u5BE9\u6838",center:!0,action:()=>g.push("/my/account")}};return(c,e)=>{const u=I,n=H,i=q;return p(),f("div",null,[s("div",P,[s("div",W,[s("div",{class:"flex items-center cursor-pointer",onClick:e[0]||(e[0]=a=>c.$router.go(-1))},[d(_(D),{class:"text-sm lg:text-base"})]),X]),s("div",{class:"group rounded-full cursor-pointer bg-green-500 text-white font-bold px-4 h-9 leading-9 flex items-center",onClick:m},[Y,d(_(U))])]),s("div",Z,[d(i,{class:"max-w-[28em]",onSubmit:m},{default:k(()=>[d(u,{modelValue:t.idCard,"onUpdate:modelValue":e[1]||(e[1]=a=>t.idCard=a),label:"\u8EAB\u5206\u8B49\u5B57\u865F",class:"mb-5",require:!0,placeholder:"\u4F8B: A123456789"},null,8,["modelValue"]),d(n,{id:"positive",modelValue:t.positive,"onUpdate:modelValue":e[2]||(e[2]=a=>t.positive=a),label:"\u8EAB\u5206\u8B49\u6B63\u9762",class:"mb-5",require:!0},null,8,["modelValue"]),d(n,{id:"negative",modelValue:t.negative,"onUpdate:modelValue":e[3]||(e[3]=a=>t.negative=a),label:"\u8EAB\u5206\u8B49\u80CC\u9762",require:!0},null,8,["modelValue"])]),_:1})])])}}});export{O as default};
